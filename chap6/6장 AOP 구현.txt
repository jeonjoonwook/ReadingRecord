AOP

UserService에 트랜잭션 경계설정을 위해 넣은 코드가 존재

비즈니스 로직과 트랜잭션 코드가 혼재되어 있다.

또한 트랜잭션 코드와 비즈니스 코드 사이에 주고 받는 데이터가 없음

즉 이 두가지 코드는 성격이 다를 뿐 아니라 서로 주고 받는것도 없는
완벽히 독립적인 코드임

비즈니스 로직을 메소드로 만들어 트랜잭션 코드로부터 분리한다.

하지만 userService안에 트랜잭션 코드가 있는게 보기 안좋음..

userServiceTest와 UserService 는 강하게 결합되어 있으므로 이 사이를
비집고 다른 무엇인가를 추가 하기가 힘들다.

userServiceTest를 userService 인터페이스에 의존하게 하고

실 구현체로 USerServiceImpl 에는 비즈니스 로직이 담기고

UserServiceTx 에는 트랜잭션 코드가 담기게 한다.

UserServiceTest -> UserServiceTx -> UserServiceImpl
의존관계 설정 됨

트랜잭션 경계설정 코드 분리의 장점은 비즈니스 로직을 수정할 때
트랜잭션과 같은 기술적인 내용을 신경쓰지 않아도 되고
이를통해 비즈니스 로직에 대한 테스트를 손쉽게 할수 있다.

부가기능(트랜잭션)은 자신이 핵심 기능을 가진 것처럼 꾸며서 클라이언트가 자신을 거쳐
핵심 기능을 사용하도로 ㄱ한다.

이렇게 마치 자신이 클라이언트가 사용하려고 하는 실제 대상인 것처럼 위장해서
클라이언트의 요청을 받아주는 것을 대리자, 대리인과 같은 역할을 한다고 하여
프록시라고 부른다.

프록시를 통해 최종적으로 요청을 위임받아 처리하는 실제 오브젝트를 타깃 또는 실체라고 부름

프록시는 사용목적에 따라 두가지로 구분
1. 클라이언트가 타깃에 접근하는 방법을 제어하기 위함
2. 타깃에 부가적인 기능을 부여해주기 위함

데코레이션 패턴 
 
타깃에 부가적인 기능을 런타임 시 다이내믹하게 부여해주기 위해 프록시를 사용하는 패턴

프록시를 여러개 쓸수 있고 순서를 정해 단계적으로 위임

프록시 패턴
프록시 패턴의 프록시는 프록시를 사용하는 방법 중에서 타깃에 대한 접근 방법을 제어하려는 목적

타깃 오브젝트를 필요한 시점까지 생성하지 않고 있다가 타깃 오브젝트에 대한 레퍼런스가 필요하면
프록시 패턴을 적용

그래서 타깃에 대한 레퍼런스 대신 프록시를 넘김

다이내믹 프록시
다이내믹 프록시는 리플랙션(자바의 코드 자체를 추상화해서 접근) 기능을 이용해서 프록시를 만든다.